dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-11-01" & Date < "2020-03-01")       # subset data for 4 months pre-covid sales
s20p <- s20p[-3, ]                                                    # remove January - a historically low sales month in all sectors that is an annual outlier
s20p$Date <- c(1:3)                                                   # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]
cumulpred <- (slps[, -18] + s20a[1, -18])                             # add Feb sales to predicted monthly sales to get March cumulative projected sales
for (j in (2:4)) {                                                    # loop to calculate cumulative predicted monthly sales
cumulpred[j, ] <- cumulpred[j-1, ] + slps
}
cumulpred <- cumulpred[4, ]                                           # cumulative predicted monthly sales from March through June
cumulpred
cumulact <- as.data.frame(t(colSums(s20a[c(2:5), -18])))              # sum March through June actual sales to get total cumulative actual sales for four months
cumulact
chngsal <- ((cumulpred- cumulact) / abs(cumulpred)) * 100             # calculate percent change in sales from projected
chngsal[2, ]  <- cumulact - cumulpred                                 # calculate dollar change in sales from projected
write.csv(t(chngsal[, -18]), "saleschange.csv", row.names = TRUE)     # write file to folder
chngsal
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-11-01" & Date < "2020-03-01")       # subset data for 4 months pre-covid sales
s20p <- s20p[-3, ]                                                    # remove January - a historically low sales month in all sectors that is an annual outlier
s20p$Date <- c(1:3)                                                   # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]
cumulpred <- (slps[, -18] + s20a[1, -18])                             # add Feb sales to predicted monthly sales to get March cumulative projected sales
for (j in (2:4)) {                                                    # loop to calculate cumulative predicted monthly sales
cumulpred[j, ] <- cumulpred[j-1, ] + slps
}
cumulpred <- cumulpred[4, ]                                           # cumulative predicted monthly sales from March through June
cumulact <- as.data.frame(t(colSums(s20a[c(2:5), -18])))              # sum March through June actual sales to get total cumulative actual sales for four months
chngsal <- ((cumulact - cumulpred) / abs(cumulpred)) * 100            # calculate percent change in sales from projected
chngsal[2, ]  <- cumulact - cumulpred                                 # calculate dollar change in sales from projected
write.csv(t(chngsal[, -18]), "saleschange.csv", row.names = TRUE)     # write file to folder
chngsal
s20a
cumulpred
cumulact
s20a
cumulact
70902                                           33544
340                      61763                                           32815
341                      93580                                           36826
342                     101736
70902+61763+93580+101736
cumulact
cumulpred
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-11-01" & Date < "2020-03-01")       # subset data for 4 months pre-covid sales
s20p <- s20p[-3, ]                                                    # remove January - a historically low sales month in all sectors that is an annual outlier
s20p$Date <- c(1:3)                                                   # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
i=1
slps[1, i]
s20p[, i]
s20p$Date
s20p
lm(s20p[, i] ~ s20p$Date)$coefficients[2]
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-08-01" & Date < "2020-03-01")       # subset data for 7 months pre-covid sales
s20p <- s20p[-3, ]                                                    # remove January - a historically low sales month in all sectors that is an annual outlier
s20p$Date <- c(1:3)                                                   # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]
cumulpred <- (slps[, -18] + s20a[1, -18])                             # add Feb sales to predicted monthly sales to get March cumulative projected sales
for (j in (2:4)) {                                                    # loop to calculate cumulative predicted monthly sales
cumulpred[j, ] <- cumulpred[j-1, ] + slps
}
cumulpred <- cumulpred[4, ]                                           # cumulative predicted monthly sales from March through June
cumulact <- as.data.frame(t(colSums(s20a[c(2:5), -18])))              # sum March through June actual sales to get total cumulative actual sales for four months
chngsal <- ((cumulact - cumulpred) / abs(cumulpred)) * 100            # calculate percent change in sales from projected
chngsal[2, ]  <- cumulact - cumulpred                                 # calculate dollar change in sales from projected
chngsal
cumulpred
cumulact
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-08-01" & Date < "2020-03-01")       # subset data for 7 months pre-covid sales
s20p <- s20p[-3, ]                                                    # remove January - a historically low sales month in all sectors that is an annual outlier
s20p$Date <- c(1:3)                                                   # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps
s20a[1, -18]
slps[, -18]
cumulpred <- (slps[, -18] + s20a[1, -18])                             # add Feb sales to predicted monthly sales to get March cumulative projected sales
for (j in (2:4)) {                                                    # loop to calculate cumulative predicted monthly sales
cumulpred[j, ] <- cumulpred[j-1, ] + slps
}
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-08-01" & Date < "2020-03-01")       # subset data for 7 months pre-covid sales
s20p <- s20p[-3, ]                                                    # remove January - a historically low sales month in all sectors that is an annual outlier
s20p$Date <- c(1:3)                                                   # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]
cumulpred <- (slps[, -18] + s20a[1, -18])                             # add Feb sales to predicted monthly sales to get March cumulative projected sales
for (j in (2:4)) {                                                    # loop to calculate cumulative predicted monthly sales
cumulpred[j, ] <- cumulpred[j-1, ] + slps
}
cumulpred <- cumulpred[4, ]                                           # cumulative predicted monthly sales from March through June
cumulact <- as.data.frame(t(colSums(s20a[c(2:5), -18])))              # sum March through June actual sales to get total cumulative actual sales for four months
chngsal <- ((cumulact - cumulpred) / abs(cumulpred)) * 100            # calculate percent change in sales from projected
chngsal[2, ]  <- cumulact - cumulpred                                 # calculate dollar change in sales from projected
cumulpred
cumulact
chngsal
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-08-01" & Date < "2020-03-01")       # subset data for 7 months pre-covid sales
s20p <- s20p[-3, ]                                                    # remove January - a historically low sales month in all sectors that is an annual outlier
s20p$Date <- c(1:3)                                                   # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
s20a
s20p
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-08-01" & Date < "2020-03-01")       # subset data for 7 months pre-covid sales
s20p <- s20p[-3, ]                                                    # remove January - a historically low sales month in all sectors that is an annual outlier
s20p$Date <- c(1:6)                                                   # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]
cumulpred <- (slps[, -18] + s20a[1, -18])                             # add Feb sales to predicted monthly sales to get March cumulative projected sales
for (j in (2:4)) {                                                    # loop to calculate cumulative predicted monthly sales
cumulpred[j, ] <- cumulpred[j-1, ] + slps
}
cumulpred <- cumulpred[4, ]                                           # cumulative predicted monthly sales from March through June
cumulact <- as.data.frame(t(colSums(s20a[c(2:5), -18])))              # sum March through June actual sales to get total cumulative actual sales for four months
chngsal <- ((cumulact - cumulpred) / abs(cumulpred)) * 100            # calculate percent change in sales from projected
chngsal[2, ]  <- cumulact - cumulpred                                 # calculate dollar change in sales from projected
chngsal
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-08-01" & Date < "2020-03-01")       # subset data for 7 months pre-covid sales
s20p <- s20p[-3, ]                                                    # remove January - a historically low sales month in all sectors that is an annual outlier
s20p$Date <- c(1:6)                                                   # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]
slps
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-08-01" & Date < "2020-03-01")       # subset data for 7 months pre-covid sales
s20p <- s20p[-3, ]                                                    # remove January - a historically low sales month in all sectors that is an annual outlier
s20p$Date <- c(1:6)                                                   # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]
View(s20a)
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-08-01" & Date < "2020-03-01")       # subset data for 7 months pre-covid sales
s20p <- s20p[-3, ]                                                    # remove January - a historically low sales month in all sectors that is an annual outlier
s20p$Date <- c(1:6)                                                   # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-08-01" & Date < "2020-03-01")       # subset data for 7 months pre-covid sales
s20p <- s20p[-3, ]                                                    # remove January - a historically low sales month in all sectors that is an annual outlier
s20p$Date <- c(1:6)                                                   # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]                                                   # remove date column
cumulpred <- (slps * 4) + s20a[1, -18]                                # multiply projected monthly sales by 4 months and add to Feb sales to get cumulative projected sales from March through June
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-08-01" & Date < "2020-03-01")       # subset data for 7 months pre-covid sales
s20p <- s20p[-3, ]                                                    # remove January - a historically low sales month in all sectors that is an annual outlier
s20p$Date <- c(1:6)                                                   # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]                                                   # remove date column
cumulpred <- (slps * 4) + s20a[1, -18]                                # multiply projected monthly sales by 4 months and add to Feb sales to get cumulative projected sales from March through June
cumulpred
s20a[1, -18]
runpp("Shinymrt")
runapp("Shinymrt")
runApp("Shinymrt")
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-01-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
s20p
s20p
View(s20p)
s20p <- subset(dat, Date >= "2019-02-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
s20p <- s20p[-3, ]                                                    # remove January - a historically low sales month in all sectors that is an annual outlier
runApp("Shinymrt")
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-02-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
View(s20p)
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-02-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
s20p$Date <- c(1:11)                                                  # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]                                                   # remove date column
slps
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-02-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
s20p$Date <- c(1:11)                                                  # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]                                                   # remove date column
cumulpred <- (slps * 4) + s20a[1, -18]                                # multiply projected monthly sales by 4 months and add to Feb sales to get cumulative projected sales from March through June
cumulpred
slps
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-02-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
s20p$Date <- c(1:11)                                                  # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]                                                   # remove date column
cumulpred <- (slps * 4) + s20a[1, -18]                                # multiply projected monthly sales by 4 months and add to Feb sales to get cumulative projected sales from March through June
cumulpred <- cumulpred[4, ]                                           # cumulative predicted monthly sales from March through June
cumulact <- as.data.frame(t(colSums(s20a[c(2:5), -18])))              # sum March through June actual sales to get total cumulative actual sales for four months
chngsal <- ((cumulact - cumulpred) / abs(cumulpred)) * 100            # calculate percent change in sales from projected
chngsal[2, ]  <- cumulact - cumulpred                                 # calculate dollar change in sales from projected
chngsal
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-02-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
s20p$Date <- c(1:11)                                                  # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]                                                   # remove date column
cumulpred <- (slps * 4) + s20a[1, -18]                                # multiply projected monthly sales by 4 months and add to Feb sales to get cumulative projected sales from March through June
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-02-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
s20p$Date <- c(1:11)                                                  # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]                                                   # remove date column
cumulpred <- (slps * 4) + s20a[1, -18]                                # multiply projected monthly sales by 4 months and add to Feb sales to get cumulative projected sales from March through June
cumulact <- as.data.frame(t(colSums(s20a[c(2:5), -18])))              # sum March through June actual sales to get total cumulative actual sales for four months
chngsal <- ((cumulact - cumulpred) / abs(cumulpred)) * 100            # calculate percent change in sales from projected
chngsal[2, ]  <- cumulact - cumulpred                                 # calculate dollar change in sales from projected
chngsal
cumulpred
cumulact
s20a[1, -18]
slps
cumulpred
lm(s20p[, i] ~ s20p$Date)
i
runApp("Shinymrt")
s20a
View(s20a)
77997length(s20p[, 1]) - 1)
length(s20p[, 1]) - 1)
length(s20p[, 1]) - 1
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-02-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
s20p$Date <- c(1:11)                                                  # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]                                                   # remove date column
cumulpred <- s20a[1, -18]                                             # multiply projected monthly sales by 4 months and add to Feb sales to get cumulative projected sales from March through June
cumulpred
2:(length(s20p[, 1]) - 1)
2:length(s20p[, 1])
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-02-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
s20p$Date <- c(1:11)                                                  # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]                                                   # remove date column
cumulpred <- s20a[1, -18]                                             # initialize a data frame with Feb 2020 sales
for(j in 2:length(s20p[, 1])) {
cumulpred[j, ] <- s20p[j-1, ] + slps
}
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-02-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
s20p$Date <- c(1:11)                                                  # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]                                                   # remove date column
cumulpred <- s20a[1, -18]                                             # initialize a data frame with Feb 2020 sales
for(j in 2:length(s20p[, 1])) {
cumulpred[j, ] <- s20p[j-1, -18] + slps
}
cumulpred
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-02-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
s20p$Date <- c(1:11)                                                  # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]                                                   # remove date column
cumulpred <- s20a[1, -18]                                             # initialize a data frame with Feb 2020 sales
for(j in 2:length(s20a[, 1])) {                                       # loop to iteratively add predicted change in sales each month, to the previous month
cumulpred[j, ] <- s20a[j-1, -18] + slps
}
cumulpred
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-02-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
s20p$Date <- c(1:11)                                                  # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]                                                   # remove date column
cumulpred <- s20a[1, -18]                                             # initialize a data frame with Feb 2020 sales
cumulpred
2:length(s20a[, 1])
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-02-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
s20p$Date <- c(1:11)                                                  # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]                                                   # remove date column
cumulpred <- s20a[1, -18]                                             # initialize a data frame with Feb 2020 sales
for(j in 2:length(s20a[, 1])) {                                       # loop to iteratively add predicted change in sales each month, to the previous month
cumulpred[j, ] <- cumulpred[j-1, -18] + slps
}
cumulpred
s20a[1, ]
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-02-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
s20p$Date <- c(1:11)                                                  # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]                                                   # remove date column
cumulpred <- s20a[1, -18]                                             # initialize a data frame with Feb 2020 sales
for(j in 2:length(s20a[, 1])) {                                       # loop to iteratively add predicted change in sales each month, to the previous month
cumulpred[j, ] <- cumulpred[j-1, -18] + slps
}
cumulpred
sum(cumulpred[c(2:5), ])
cumulpred[c(2:5), ]
v
colSums(cumulpred[c(2:5), ])
cumulpred <- colSums(cumulpred[c(2:5), ])
cumulpred <- as.data.frame(tcolSums(cumulpred[c(2:5), ]))
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-02-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
s20p$Date <- c(1:11)                                                  # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]                                                   # remove date column
cumulpred <- s20a[1, -18]                                             # initialize a data frame with Feb 2020 sales
for(j in 2:length(s20a[, 1])) {                                       # loop to iteratively add predicted change in sales each month, to the previous month
cumulpred[j, ] <- cumulpred[j-1, -18] + slps
}
cumulpred <- as.data.frame(t(colSums(cumulpred[c(2:5), ])))
cumulpred
s20a[c(2:5), -18]
cumulact <- as.data.frame(t(colSums(s20a[c(2:5), -18])))              # sum March through June actual sales to get total cumulative actual sales for four months
cumulact
cumulpred
chngsal <- ((cumulact - cumulpred) / abs(cumulpred)) * 100            # calculate percent change in sales from projected
chngsal[2, ]  <- cumulact - cumulpred                                 # calculate dollar change in sales from projected
write.csv(t(chngsal[, -18]), "saleschange.csv", row.names = TRUE)     # write file to folder
chngsal
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-02-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
s20p$Date <- c(1:11)                                                  # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]                                                   # remove date column
cumulpred <- s20a[1, -18]                                             # initialize a data frame with Feb 2020 sales
for(j in 2:length(s20a[, 1])) {                                       # loop to iteratively add predicted change in sales each month, to the previous month
cumulpred[j, ] <- cumulpred[j-1, -18] + slps
}
cumulpred <- as.data.frame(t(colSums(cumulpred[c(2:5), ])))
cumulact <- as.data.frame(t(colSums(s20a[c(2:5), -18])))              # sum March through June actual sales to get total cumulative actual sales for four months
chngsal <- ((cumulact - cumulpred) / abs(cumulpred)) * 100            # calculate percent change in sales from projected
chngsal[2, ]  <- cumulact - cumulpred                                 # calculate dollar change in sales from projected
write.csv(t(chngsal[, -18]), "saleschange.csv", row.names = TRUE)     # write file to folder
chngsal
dat <- read.csv("spending.csv", header = TRUE)                        # load cleaned data
dat$Date <- as.Date(dat$Date, "%Y-%m-%d")                             # set date as date
s20p <- subset(dat, Date >= "2019-02-01" & Date < "2020-01-01")       # subset data for 7 months pre-covid sales
s20p$Date <- c(1:11)                                                  # change date to numeric to make x-scale unit in linear regression = month instead of day
s20a <- subset(dat, Date >= "2020-02-01" & Date < "2020-07-01")       # subset data for 1 month pre-covid sales and 4 months of covid sales
slps <- as.data.frame(matrix(ncol = ncol(s20p)))                      # initialize a data frame
colnames(slps) <- colnames(s20p)                                      # copy data frame column names
for (i in 1:(length(s20p[1, ]) - 1)) {                                # loop through columns and fit lm to each one
slps[1, i] <- lm(s20p[, i] ~ s20p$Date)$coefficients[2]
}
slps <- slps[, -18]                                                   # remove date column
cumulpred <- s20a[1, -18]                                             # initialize a data frame with Feb 2020 sales
for(j in 2:length(s20a[, 1])) {                                       # loop to iteratively add predicted change in sales each month, to the previous month
cumulpred[j, ] <- cumulpred[j-1, -18] + slps
}
cumulpred <- as.data.frame(t(colSums(cumulpred[c(2:5), ])))
cumulact <- as.data.frame(t(colSums(s20a[c(2:5), -18])))              # sum March through June actual sales to get total cumulative actual sales for four months
chngsal <- ((cumulact - cumulpred) / abs(cumulpred)) * 100            # calculate percent change in sales from projected
chngsal[2, ]  <- cumulact - cumulpred                                 # calculate dollar change in sales from projected
write.csv(t(chngsal), "saleschange.csv", row.names = TRUE)     # write file to folder
